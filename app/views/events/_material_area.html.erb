<% if can? :view_material, Event %>
  <a name="material_area"></a>
  <%= render( partial: 'material_sub_dir_modal' ) %>
  <%= render( partial: 'material_move_modal' ) %>
  <div class="col-xs-12 col-sm-12 col-md-10 col-lg-10 col-xs-offset-0 col-sm-offset-0 col-md-offset-1 col-lg-offset-1" id="event_material_area">
    <h3><%= t '.title', title: @event.name %></h3>

    <ul>
      <% @material_files.each do |file| %>
          <%= render( partial: 'material_item', locals: { file: file }) %>
      <% end %>
    </ul>


    <script type="application/javascript">
      $(function(){
        function openAddDirModal(){
          $('#material_sub_dir_path').val($(this).data('path'));
          $('#material_sub_dir_modal').modal('show');
        }

        function openMoveModal(){
          $('#material_move_path').val($(this).data('path'));
          $('#material_move_modal').modal('show');
        }

        $('.move-dir-button').click(openMoveModal);
        $('.add-dir-button').click(openAddDirModal)
      });
    </script>

    <% if can? :upload_material, Event %>
      <button class="btn btn-default add-dir-button" data-path=""><%= t('events.material_area.create_dir') %></button>
      <%= form_tag(event_upload_material_path(@event), class: 'btn btn-default', multipart: true) do %>

          <%= file_field_tag "file_upload",
                             class: "btn btn-default btn-file",
                             style: 'display:inline',
                             id: "material_upload_#{@event.id}" %>
          <%= submit_tag t('.upload'),
                         class: 'btn btn-default',
                         id: "material_upload_btn_#{@event.id}"%>
      <% end %>
    <% end %>
    <div class="spacer-30"></div>
  </div>
<% end %>

